<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Speed Writer</title>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
                
        <script type="text/javascript">
            M.AutoInit();

            var totalTime = 600000;
            var totalWords = 500;
            var WPMGoal = totalWords/(totalTime/60000);
            var wordsWritten = 0;
            var WPM = wordsWritten/(totalTime/60000);
            var timePassed = 0;

            function startWriting(){
                document.getElementById("timer").disabled = true;
                document.getElementById("words").disabled = true;
                timePassed = 0;
                var t = setInterval(writing, 1000);
            }

            function writing(){
                timePassed++;
                //wpm display
                document.getElementById("TSF").innerHTML = timePassed;
                if(timePassed == totalTime){
                    document.getElementById("text").disabled = true;
                    clearInterval(t);
                }
            }

            function changeTime(timercount){
                document.getElementById("time").innerHTML = timercount;
                totalTime = timercount * 60000;
            }

            function changeWords(wordcount){
                document.getElementById("wordcount").innerHTML = wordcount;
                totalWords = wordcount;
            }

            function count_word(val){
                var wom = val.match(/\S+/g);
                return {
                    words : wom ? wom.length : 0
                }
            }

            function inputChanged(val){
                var v = count_word(val);
                wordsWritten = v.words;
                document.getElementById("WSF").innerHTML = wordsWritten;
            };

        </script>

    </head>

    <body>
        <div class="container">
            <div class="row">
                <div class="input-field">
                    <h1>Speed Writer</h1>
                    <h6>Set a time and a word count. Challenge yourself to improve.</h6>
                </div>
            </div>

            <div class="row">
                <div class="col s6">

                    <div class="row">
                        <i class="material-icons prefix">keyboard</i>
                        <input type="range" id="words" min="0" max="1500" value="500" onchange="changeWords(this.value)"/>
                        <label for="words">number of words</label>
                    </div>

                    <div class="row">
                        <i class="material-icons prefix">access_time</i>
                        <input type="range" id="timer" min="0" max="30" value="10" onchange="changeTime(this.value)"/>
                        <label for="timer">time (minutes)</label>
                    </div>

                </div>

                <div class="col s6">
                    <h5 style="text-align: center;" id="WPM"><span id="wordcount">500</span> words in <span id="time">10</span> minutes</h5>
                    <h5 style="text-align: center;">Words so far: <span id="WSF">0</span></h5>
                    <h6 style="text-align: center;">Time: <span id="TSF">0</span></h6>
                </div>

            </div>
            
            <div class="divider"></div>

            <div class="row">
                <h6 style="text-align: center;">Timer will start when you click on the text box below.</h6>
            </div>

            <div class="row">
                <div class="input-field">
                <textarea id="text" class="materialize-textarea" onfocus="startWriting()" oninput="inputChanged(this.value)"></textarea>
                <label for="text">Write</label>
                </div>
            </div>
        </div>
    </body>
</html>